import datasets
rouge = datasets.load_metric('rouge')
ref_path = "./test_output/mamba-1.4b/ref-tms_test.txt"
pre_path = "./test_output/mamba-1.4b/tms_test.txt"
with open(ref_path, 'r') as f:
    references = f.readlines()
with open(pre_path, 'r') as f:
    predictions = f.readlines()
# predictions = ["At Pine Valley Hospital, Angie examines Rebecca and finds that she is indeed pregnant. At the Confusion bar, J.R. and Colby sit at a table and discuss the case that is closed. J.R. asks Colby to go with him to see Little A so that he can show her how much he loves her. David sits at a table at the Yacht Club when Krystal walks in. David immediately thinks that she is there to kill him. David tells Krystal that he is no better than Babe. Tad walks in and watches David and Krystal together. At the Pine Valley Inn, Randi walks into the lobby and finds Frankie, who tells her that he has a special case for her. Jesse and Greenlee discuss the case that they are working on in finding the kidnapper who may have taken Annie. Jesse calls Ryan to let him know that they had found Annie and Emma. Ryan, immediately, leaves the hotel room. Annie and Emma are tied up in a chair. Emma begs Ryan to let them go. Ryan, reluctantly, agrees. Zach and Reese decide to have a wedding in Pine Valley. Zach and Reese leave the casino and go to the hospital for Zach and Kendall to sign the papers for Reese's possible bone marrow transplant. Bianca and Reese decide to have a wedding in Pine Valley. Krystal tells David that she is no better than Babe. David lets Krystal know that he is no better than Babe. Krystal tells David that he had ruined her life. David tells Krystal that he is no better than Babe. Krystal tells David that he had ruined her life. David tells Krystal that he is no better than Babe. Krystal tells David that she is no better than Babe. Jesse and Greenlee come in and lets them know that they had been unable to find the kidnapper. Ryan and Annie come in and tells them that they had found the kidnapper and he is Annie's father. Ryan and Annie beg for Jesse and Greenlee to let them go, too, but they refuse. Ryan and Annie leave with the kidnapper. Greenlee and Jesse realize that they had made a mistake in bringing Annie and Emma here. Ryan and Annie find out that the kidnapper had been a previous owner of a liquor store. Ryan and Annie go looking for the kidnapper. Ryan and Annie find Emma tied up. Ryan and Annie realize that they are both victims of kidnappers."]
# references = ["At Wild Wind , Krystal keeps David from killing himself . At the Chandler mansion , Colby informs J.R. that she and Adam will be accompanying him to the cemetery to say their final good - byes to Babe . Zach visits Kendall and finds her still unconscious . He places a pic of the boys on the monitor . Bianca accepts Reese 's marriage proposal . They decide to get married in Pine Valley . Rebecca faints in Natalia 's room . Greenlee and Jesse find Ryan and Annie gone from the hospital room . Ryan and Annie visit an old abandoned building that the kidnapper had told them to go to . Jesse puts out an A.P.B. on the kidnapper . Annie is beside herself with worry about Emma when the kidnapper comes up behind them . He tells them not to turn around . The kidnapper kidnaps Annie . Frankie tells Randi all about Rebecca and Natalia . Jesse and Greenlee arrive at the old abandoned building and find that the kidnapper had taken Annie . The Chandlers and the Martins say their final good - byes to Babe at the cemetery . To everyone 's surprise , David arrives to say his good - byes and to apologize to the Chandler family . No one believes that he is not out for revenge against the Chandler 's and Martin 's . Angie and Frankie tell Natalie that Rebecca has an inoperable brain tumor . Ryan gets a call from Annie telling him that Emma is alive ."]
results = rouge.compute(predictions=predictions,
                        references=references)
print(list(results.keys()))
print(results)
print(results["rouge1"].mid.fmeasure)
print(results["rouge2"].mid.fmeasure)
print(results["rougeL"].mid.fmeasure)
print(results["rougeLsum"].mid.fmeasure)